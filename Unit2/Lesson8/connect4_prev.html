<!DOCTYPE html>
<html lang="zh-Hans">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Â≤≥È£ûÂ≠¶ÂÜôÂ≠ó üåø Â§ç‰π†Âê¨ÂÜô Connect 4 ‚ö°</title>
    <style>
        /* Ocean theme background */
        body {
            background: linear-gradient(135deg, #66b2e6 0%, #0092d3 50%, #005b99 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            color: #fff;
            font-family: "Microsoft Yahei", system-ui, BlinkMacSystemFont, "Segoe UI", sans-serif;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image:
                radial-gradient(ellipse 15% 8% at 25% 75%, rgba(160, 82, 45, 0.1) 0%, transparent 50%),
                radial-gradient(circle 6% at 75% 35%, rgba(139, 69, 19, 0.08) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }

        .game-container {
            width: 100%;
            max-width: 900px;
            background-color: rgba(255, 255, 255, 0.06);
            border-radius: 25px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
            border: 2px solid rgba(255, 255, 255, 0.4);
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .game-header {
            background: linear-gradient(to right, #0077b6, #005b99);
            color: #ffe08a;
            text-align: center;
            padding: 25px 30px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.4);
            position: relative;
        }

        .game-header h1 {
            font-size: 2.4rem;
            letter-spacing: 1px;
            margin-bottom: 10px;
            text-shadow: 0 0 8px rgba(0, 0, 0, 0.5);
        }

        /* Consistent Navigation Menu */
        .dropdown-container {
            position: absolute;
            top: 20px;
            left: 20px;
        }

        .dropbtn {
            background-color: rgba(0, 0, 0, 0.4);
            color: #ffe08a;
            font-size: 22px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            padding: 6px 10px;
            transition: background 0.3s ease;
        }

        .dropbtn:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }

        .dropdown-content {
            display: none;
            position: absolute;
            background-color: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(15px);
            min-width: 200px;
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.6);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            margin-top: 8px;
            z-index: 1000;
            padding: 4px 0;
        }

        .dropdown-content a {
            color: #ffe08a;
            padding: 14px 20px;
            text-decoration: none;
            display: block;
            transition: all 0.2s ease;
            font-size: 0.95rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .dropdown-content a:last-child {
            border-bottom: none;
        }

        .dropdown-content a:hover {
            background: rgba(255, 235, 138, 0.3);
            color: #fff;
            padding-left: 24px;
            transform: translateX(4px);
        }

        .dropdown-content a.active {
            background: rgba(255, 235, 59, 0.4);
            font-weight: bold;
        }

        .show {
            display: block;
        }

        .branch-decoration {
            position: absolute;
            width: 70px;
            height: 50px;
            top: 18px;
            right: 25px;
        }

        .branch-main {
            width: 50px;
            height: 16px;
            background: linear-gradient(145deg, #8b4513, #654321);
            border-radius: 8px;
            position: absolute;
            bottom: 0;
            right: 8px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.4);
        }

        .branch-leaf {
            width: 20px;
            height: 20px;
            background: radial-gradient(ellipse, #90ee90 40%, #228b22 80%);
            border-radius: 50% 30% 70% 30%;
            position: absolute;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.2);
        }

        .leaf1 {
            top: -10px;
            left: 10px;
        }

        .leaf2 {
            top: -8px;
            right: -3px;
        }

        .main-content {
            padding: 30px;
        }

        #status {
            font-size: 1.5rem;
            margin-bottom: 20px;
            font-weight: bold;
            text-align: center;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
        }

        #turn-indicator {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 25px;
            background: rgba(255, 255, 255, 0.15);
            padding: 15px 25px;
            border-radius: 50px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            align-items: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .chip-display {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            border: 4px solid rgba(255, 255, 255, 0.4);
            transition: all 0.3s ease;
            opacity: 0.7;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
        }

        .chip-display.active {
            opacity: 1;
            border-color: #ffe08a;
            transform: scale(1.15);
            box-shadow: 0 6px 20px rgba(255, 224, 138, 0.6);
        }

        #board {
            display: grid;
            grid-template-columns: repeat(7, 85px);
            grid-template-rows: repeat(6, 85px);
            gap: 12px;
            background: linear-gradient(145deg, rgba(0, 91, 153, 0.9), rgba(43, 87, 151, 0.9));
            padding: 20px;
            border-radius: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.5), inset 0 0 20px rgba(255, 255, 255, 0.1);
            margin-bottom: 25px;
        }

        .slot-circle {
            width: 80px;
            height: 80px;
            background: rgba(255, 255, 255, 0.25);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            text-align: center;
            font-size: 0.85rem;
            font-weight: bold;
            color: #ffe08a;
            padding: 6px;
            box-sizing: border-box;
            transition: all 0.3s ease;
            box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.3), 0 4px 12px rgba(0, 0, 0, 0.4);
            border: 2px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(5px);
        }

        .slot-circle:hover {
            transform: scale(1.08);
            background: rgba(255, 255, 255, 0.4);
            box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.3), 0 8px 20px rgba(0, 0, 0, 0.5);
        }

        .slot-circle.red {
            background: rgba(255, 62, 62, 0.9);
            color: white;
            transform: scale(1);
            box-shadow: 0 6px 20px rgba(255, 62, 62, 0.6);
            border-color: rgba(255, 100, 100, 0.8);
        }

        .slot-circle.yellow {
            background: rgba(255, 219, 58, 0.95);
            color: #005b99;
            transform: scale(1);
            box-shadow: 0 6px 20px rgba(255, 219, 58, 0.7);
            border-color: rgba(255, 235, 59, 0.8);
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        button {
            padding: 12px 28px;
            font-size: 1.1rem;
            color: #005b99;
            background-color: #ffe08a;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        button:hover {
            transform: scale(1.05) translateY(-2px);
            background-color: #fff59d;
            box-shadow: 0 8px 20px rgba(255, 234, 138, 0.6);
        }

        @media (max-width: 768px) {
            #board {
                grid-template-columns: repeat(7, 65px);
                grid-template-rows: repeat(6, 65px);
                gap: 8px;
                padding: 15px;
            }

            .slot-circle {
                width: 60px;
                height: 60px;
                font-size: 0.75rem;
            }
        }
    </style>
</head>

<body>
    <div class="game-container">
        <div class="game-header">
            <div class="dropdown-container">
                <button class="dropbtn">‚ò∞</button>
                <div class="dropdown-content">
                    <a href="read.html">üìñ ÈòÖËØª</a>
                    <a href="wordice.html">üé≤ Â≠óÂç°È™∞Â≠ê</a>
                    <a href="splice.html">üß© Âè•Â≠êÊãºÂõæ</a>
                    <a href="connect4_prev.html" class="active">üéÆÂê¨ÂÜôÔºà‰∏äÔºâ Connect 4</a>
                    <a href="quiz_prev.html">‚ö° ÈóØÂÖ≥Ê∏∏ÊàèÔºà‰∏äÔºâ</a>
                    <a href="quiz.html">‚ö° ÈóØÂÖ≥Ê∏∏ÊàèÔºà‰∏ãÔºâ</a>
                    <a href="connect4.html">üéÆÂê¨ÂÜôÔºà‰∏ãÔºâ Connect 4</a>
                </div>
            </div>
            <h1>‚ö° Â≤≥È£ûÂ≠¶ÂÜôÂ≠óüåøÔºà‰∏äÔºâÂê¨ÂÜô Connect 4</h1>
            <p>ÁÇπÂáªÊ±âÂ≠óÁªÑÊàê4ËøûÁ∫øÔºåÂ§ç‰π†Â≤≥È£ûÊïÖ‰∫ãÈáçÁÇπËØçÊ±áÔºÅÁ∫¢ÈªÑËΩÆÊµÅÔºåÂÖàËøû4‰∏™Áõ∏ÂêåÈ¢úËâ≤Ëé∑ËÉúÔºÅ</p>
            <div class="branch-decoration">
                <div class="branch-main"></div>
                <div class="branch-leaf leaf1"></div>
                <div class="branch-leaf leaf2"></div>
            </div>
        </div>

        <div class="main-content">
            <div id="status">üî¥ Á∫¢Ê£ãÂºÄÂßãÔºÅ</div>

            <div id="turn-indicator">
                <div id="display-red" class="chip-display active" style="background: rgba(255, 62, 62, 0.9);"></div>
                <span>ËΩÆÂà∞</span>
                <div id="display-yellow" class="chip-display" style="background: rgba(255, 219, 58, 0.95);"></div>
            </div>

            <div id="board"></div>

            <div class="controls">
                <button onclick="resetGame()">ÈáçÊñ∞ÂºÄÂßã üîÑ</button>
            </div>
        </div>
    </div>

    <script>
        // Large pool of words to draw from
        const WORD_POOL = [
            "ÂêçÂ≠ó", "ÁôæÊàòÁôæËÉú", "ÂÖ≠Â≤Å", "Â≠¶Ê†°", "ËÄÅÂ∏à", "Â•ΩÂïä", "ÊãøÁùÄ", "ÂÜôÂ≠ó", "Âçñ‰∫Ü", "‰π∞‰∫õ", "Á∫∏Á¨î",
            "Ëµ∞‰∏¢", "ÁùÄÊÄ•", "Â∑¶ËÑö", "ËÉå‰∏ä", "Ëúú", "Á±≥", "ÁâôÈΩø", "‰∏çÊÖ¢", "ÁîüÊ∞î", "ÂàöÊâç", "Âí¨Ëøá", "ÊØîËæÉ", "ÊåáÁÇπ",
            "Ëø∑Ë∑Ø", "ÂçÉ‰∏á", "Ë¶ÅÊòØ", "Ëá™ÁÑ∂", "Â§™Èò≥", "Â§©Á©∫", "Â∏ÆÂøô", "Ê†ëÂΩ±", "Ê∞∏Ëøú", "ËÆ§Âá∫", "ÈªëÂ§ú", "ÁâπÂà´",
            "ÊîπÂèò", "Êò®Â§©", "Ê∏ÖÊ•ö", "ÊîæÂøÉ", "Êõ¥Â•Ω", "Á≠îÂ∫î", "ÁóÖ‰∫Ü", "Êï£Ê≠•", "ËÅ™Êòé", "Ê±ÇÊÇ®", "ÂãáÊï¢", "ÊÑüÂä®"
        ];
        const ROWS = 6; const COLS = 7;
        let currentPlayer = 'red';
        let boardState = [];
        let gameOver = false;

        // Function to shuffle the pool and pick 42 words
        function getRandomWords() {
            let shuffled = [...WORD_POOL].sort(() => 0.5 - Math.random());
            return shuffled.slice(0, 42);
        }

function initBoard() {
            const board = document.getElementById('board');
            board.innerHTML = '';
            boardState = Array(ROWS).fill().map(() => Array(COLS).fill(null));
            gameOver = false;
            
            const selectedWords = getRandomWords();
            
            selectedWords.forEach((word, i) => {
                const r = Math.floor(i / COLS);
                const c = i % COLS;
                const circle = document.createElement('div');
                circle.classList.add('slot-circle');
                circle.innerText = word;
                circle.id = `slot-${r}-${c}`;
                circle.onclick = () => handleMove(r, c);
                board.appendChild(circle);
            });
            updateTurnDisplay();
        }

        function handleMove(r, c) {
            if (gameOver || boardState[r][c]) return;

            // üéµ NEW: Play drop sound when piece is placed
            playDropSound();
            
            boardState[r][c] = currentPlayer;
            const circle = document.getElementById(`slot-${r}-${c}`);
            circle.classList.add(currentPlayer);

            if (checkWin(r, c)) {
                // üéµ NEW: Play victory sound
                setTimeout(() => playWinSound(), 100);
                document.getElementById('status').innerHTML = `üéâ <strong>${currentPlayer === 'red' ? 'üî¥ Á∫¢Ê£ã' : 'üü° ÈªÑÊ£ã'} Ëé∑ËÉúÔºÅ</strong>`;
                gameOver = true;
                return;
            }

            currentPlayer = (currentPlayer === 'red') ? 'yellow' : 'red';
            updateTurnDisplay();
        }
        
        function updateTurnDisplay() {
            if (gameOver) return;
            document.getElementById('status').innerHTML =
                currentPlayer === 'red' ? 'üî¥ Á∫¢Ê£ãËΩÆÂà∞‰Ω†ÔºÅ' : 'üü° ÈªÑÊ£ãËΩÆÂà∞‰Ω†ÔºÅ';
            document.getElementById('display-red').classList.toggle('active', currentPlayer === 'red');
            document.getElementById('display-yellow').classList.toggle('active', currentPlayer === 'yellow');
        }

        function checkWin(r, c) {
            const directions = [[0, 1], [1, 0], [1, 1], [1, -1]];
            for (let [dr, dc] of directions) {
                let count = 1;
                // Positive direction
                for (let i = 1; i <= 3; i++) {
                    let nr = r + dr * i, nc = c + dc * i;
                    if (nr >= 0 && nr < ROWS && nc >= 0 && nc < COLS && boardState[nr][nc] === currentPlayer) count++;
                    else break;
                }
                // Negative direction
                for (let i = 1; i <= 3; i++) {
                    let nr = r - dr * i, nc = c - dc * i;
                    if (nr >= 0 && nr < ROWS && nc >= 0 && nc < COLS && boardState[nr][nc] === currentPlayer) count++;
                    else break;
                }
                if (count >= 4) return true;
            }
            return false;
        }

        function resetGame() {
            currentPlayer = 'red';
            initBoard();
        }
        // üéµ NEW: Web Audio API Sound Functions
        function playDropSound() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();

            // Main drop sound - descending pitch "thunk"
            const osc1 = audioContext.createOscillator();
            const gain1 = audioContext.createGain();
            osc1.connect(gain1);
            gain1.connect(audioContext.destination);

            osc1.frequency.setValueAtTime(200, audioContext.currentTime);
            osc1.frequency.exponentialRampToValueAtTime(80, audioContext.currentTime + 0.15);
            osc1.type = 'sine';

            gain1.gain.setValueAtTime(0.25, audioContext.currentTime);
            gain1.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.15);

            osc1.start(audioContext.currentTime);
            osc1.stop(audioContext.currentTime + 0.15);

            // Subtle rattle/impact after drop
            setTimeout(() => {
                const osc2 = audioContext.createOscillator();
                const gain2 = audioContext.createGain();
                osc2.connect(gain2);
                gain2.connect(audioContext.destination);

                osc2.frequency.value = 120;
                osc2.type = 'square';

                gain2.gain.setValueAtTime(0.15, audioContext.currentTime);
                gain2.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.08);

                osc2.start(audioContext.currentTime);
                osc2.stop(audioContext.currentTime + 0.08);
            }, 100);
        }

        function playWinSound() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();

            // Victory fanfare - rising major chord
            const notes = [
                { freq: 523, duration: 0.4 },  // C5
                { freq: 659, duration: 0.4 },  // E5  
                { freq: 784, duration: 0.8 }   // G5
            ];

            let time = 0;
            notes.forEach(note => {
                const osc = audioContext.createOscillator();
                const gain = audioContext.createGain();

                osc.connect(gain);
                gain.connect(audioContext.destination);

                osc.frequency.value = note.freq;
                osc.type = 'sine';

                gain.gain.setValueAtTime(0.3, audioContext.currentTime + time);
                gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + time + note.duration);

                osc.start(audioContext.currentTime + time);
                osc.stop(audioContext.currentTime + time + note.duration);

                time += note.duration * 1.1;
            });

            // Sparkle/trill effect at end
            setTimeout(() => {
                for (let i = 0; i < 6; i++) {
                    setTimeout(() => {
                        const sparkleOsc = audioContext.createOscillator();
                        const sparkleGain = audioContext.createGain();
                        sparkleOsc.connect(sparkleGain);
                        sparkleGain.connect(audioContext.destination);

                        sparkleOsc.frequency.value = 1200 + Math.random() * 800;
                        sparkleOsc.type = 'triangle';

                        sparkleGain.gain.setValueAtTime(0.2, audioContext.currentTime);
                        sparkleGain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);

                        sparkleOsc.start(audioContext.currentTime);
                        sparkleOsc.stop(audioContext.currentTime + 0.1);
                    }, i * 50);
                }
            }, 800);
        }
        // Dropdown functionality
        document.querySelector(".dropbtn").addEventListener("click", function () {
            document.querySelector(".dropdown-content").classList.toggle("show");
        });

        window.addEventListener("click", function (event) {
            if (!event.target.matches(".dropbtn")) {
                const dropdowns = document.querySelectorAll(".dropdown-content");
                dropdowns.forEach((dropdown) => {
                    if (dropdown.classList.contains("show")) {
                        dropdown.classList.remove("show");
                    }
                });
            }
        });

        initBoard();
    </script>
</body>

</html>